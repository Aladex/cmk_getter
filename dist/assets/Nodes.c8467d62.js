import{_ as g,j as k,i as b,k as v,V as x,d as i}from"./VTable.36fae3de.js";import{Q as t,R as n,U as a,b as h,_ as s,X as u,Y as f,F as p,W as m,V as d,a3 as N,a4 as S}from"./index.f8ddea71.js";const V={name:"Nodes",data(){return{nodes:{},headers:[{text:"Host",value:"host"},{text:"SSH",value:"is_available"},{text:"Plugins",value:"plugins"}]}},methods:{async getNodes(){const e=await fetch("/api/ssh-nodes");this.nodes=await e.json()},async updatePlugin(e,r){await fetch("/api/deploy-plugin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node:e,plugin:r})}),this.nodes[e].plugins.forEach(l=>{l.name===r&&(l.loading=!0)}),setTimeout(()=>{this.getNodes(),this.nodes[e].plugins.forEach(l=>{l.name===r&&delete l.loading})},1e4)}},mounted(){this.getNodes()}},w=e=>(N("data-v-e2bc46b2"),e=e(),S(),e),C=w(()=>s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Name"),s("th",{class:"text-left"},"Plugins"),s("th",{class:"text-left"},"SSH")])],-1));function I(e,r,l,P,_,y){return t(),n(k,{fluid:"",class:"fill-height"},{default:a(()=>[h(x,null,{default:a(()=>[h(b,{cols:"12",md:"10","offset-md":"1"},{default:a(()=>[h(v,{headers:_.headers,items:_.nodes,class:"elevation-1"},{default:a(()=>[C,s("tbody",null,[(t(!0),u(p,null,f(_.nodes,c=>(t(),u("tr",{key:c.name},[s("td",null,m(c.host),1),s("td",null,[s("ul",null,[(t(!0),u(p,null,f(c.plugins,o=>(t(),u("li",{key:o.name,class:"justify-space-between"},[d(m(o.name)+": ",1),o.is_actual===!0?(t(),n(i,{key:0,color:"green"},{default:a(()=>[d("mdi-check")]),_:1})):o.is_actual===!1&&o.loading!==!0?(t(),n(i,{key:1,color:"red",onClick:T=>y.updatePlugin(c.host,o.name)},{default:a(()=>[d("mdi-close")]),_:2},1032,["onClick"])):(t(),n(i,{key:2,color:"blue",class:"loading"},{default:a(()=>[d("mdi-loading")]),_:1}))]))),128))])]),s("td",null,[c.is_available?(t(),n(i,{key:0},{default:a(()=>[d("mdi-check")]),_:1})):(t(),n(i,{key:1},{default:a(()=>[d("mdi-close")]),_:1}))])]))),128))])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})}const E=g(V,[["render",I],["__scopeId","data-v-e2bc46b2"]]);export{E as default};
